<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mood • Senang</title>
  <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet" />
  <style>body{font-family:"Poppins",sans-serif}</style>
</head>
<body class="text-gray-800">
<header class="bg-[#e8b9c2] shadow-sm">
  <div class="container mx-auto flex items-center justify-between py-4 px-4 md:px-8">
    <a href="/" class="text-2xl font-extrabold tracking-wider text-yellow-600 select-none">MOOD COOK</a>
    <nav class="hidden md:flex gap-8 text-sm font-semibold uppercase">
      <a href="/"              class="hover:text-yellow-600">Beranda</a>
      <a href="/#tentang"       class="hover:text-yellow-600">Tentang Kami</a>
      <a href="/recipe.html"   class="hover:text-yellow-600">Resep</a>
    </nav>
    <a id="nav-login" href="/login.html" class="hide-when-auth hidden md:inline-block bg-pink-300 text-white font-semibold px-6 py-2 rounded-full hover:bg-pink-400 transition">Masuk</a>
    <div id="user-box" class="relative hidden md:inline-block">
      <span id="nav-user" class="cursor-pointer font-semibold text-gray-700 select-none"></span>
      <div id="user-menu" class="hidden absolute right-0 mt-2 w-32 bg-white border border-gray-200 rounded-lg shadow-lg z-50">
        <form method="POST" action="/api/logout"><button type="submit" class="block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Logout</button></form>
      </div>
    </div>
  </div>
</header>
<section class="pt-12 pb-10 text-center">
  <h2 class="text-xl md:text-2xl font-semibold leading-relaxed max-w-3xl mx-auto">Hmm… kamu lagi kesal ya?<br />Tenang, ini pilihan yang bisa bantu kamu lebih rileks</h2>
  <p class="mt-8 text-lg font-medium">Mood Kamu :</p>
  <div class="mt-4 flex flex-col items-center gap-4">
    <img src="assets/marah.png" alt="Happy Mood" class="w-36 select-none" draggable="false" />
    <span class="text-lg font-semibold">MARAH !!!!!</span>
  </div>
</section>
<section>
  <div class="bg-red-700/90 font-semibold text-center text-sm border-2 border-black">
    <div class="py-3">RESEP yang COCOK untuk MOOD KAMU !!!</div>
  </div>
  <div class="flex justify-center py-10 px-4">
    <div id="recipe-list" class="flex flex-col items-center gap-10"><p class="text-sm text-gray-500">Memuat rekomendasi resep...</p></div>
  </div>
</section>
    <!-- ===== FOOTER ===== -->
    <footer class="bg-[#e8b9c2] py-16 text-sm text-gray-100">
      <div class="container mx-auto grid grid-cols-1 md:grid-cols-3 gap-8 px-6 md:px-8">

        <!-- kolom kiri -->
        <div class="space-y-5">
          <h3 class="text-lg font-semibold text-white">Mood Cook</h3>
          <ul class="space-y-1">
            <li>Kontak • +6281234568899</li>
            <li>Email • hi@moodcook.com</li>
            <li>Instagram • mood.cook</li>
          </ul>

          <!-- ikon sosmed -->
          <div class="flex gap-4 pt-4">
            <!-- instagram -->
            <a href="#" aria-label="Instagram" class="hover:text-white/80">
              <svg class="w-7 h-7" fill="currentColor" viewBox="0 0 24 24">
                <path d="M7 2C4.8 2 3 3.8 3 6v12c0 2.2 1.8 4 4 4h10c2.2 0 4-1.8 4-4V6c0-2.2-1.8-4-4-4H7zm10 2c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H7c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2h10zm-5 3.5A4.5 4.5 0 1 0 16.5 12 4.5 4.5 0 0 0 12 7.5zm0 7.3A2.8 2.8 0 1 1 14.8 12 2.8 2.8 0 0 1 12 14.8zm4.1-8.9a1 1 0 1 1-1-1 1 1 0 0 1 1 1z"/>
              </svg>
            </a>
            <!-- twitter -->
            <a href="#" aria-label="Twitter" class="hover:text-white/80">
              <svg class="w-7 h-7" fill="currentColor" viewBox="0 0 24 24">
                <path d="M22 5.9a8.2 8.2 0 0 1-2.4.7 4.2 4.2 0 0 0 1.8-2.3 8.3 8.3 0 0 1-2.7 1A4.2 4.2 0 0 0 11 8.2a11.9 11.9 0 0 1-8.6-4.4 4.2 4.2 0 0 0 1.3 5.6 4.1 4.1 0 0 1-1.9-.5v.1a4.2 4.2 0 0 0 3.4 4.1 4.2 4.2 0 0 1-1.9.1 4.2 4.2 0 0 0 3.9 3 8.5 8.5 0 0 1-5.3 1.9h-.9a12 12 0 0 0 6.6 1.9c8 0 12.4-6.6 12.4-12.4v-.6A8.7 8.7 0 0 0 22 5.9z"/>
              </svg>
            </a>
            <!-- tiktok -->
            <span class="w-5 h-5">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="currentColor"
                viewBox="0 0 448 512">
                <!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc. -->
                <path
                  d="M448 209.9a210.1 210.1 0 0 1 -122.8-39.3V349.4A162.6 162.6 0 1 1 185 188.3V278.2a74.6 74.6 0 1 0 52.2 71.2V0l88 0a121.2 121.2 0 0 0 1.9 22.2h0A122.2 122.2 0 0 0 381 102.4a121.4 121.4 0 0 0 67 20.1z" />
              </svg>
            </span>
          </div>
        </div>

        <!-- kolom tengah – LOGO CARD (ganti seluruh blok ini) -->
        <div class="flex justify-center">
          <div
            class="bg-amber-100/90 border-amber-300 rounded-2xl w-64 h-64  <!-- ukuran kotak -->
                  flex items-center justify-center shadow">
            <img src="assets/moodcook.png"
                alt="MoodCook logo"
                class="w-full h-full object-contain select-none rounded-lg" />  <!-- isi penuh -->
          </div>
        </div>

        <!-- kolom kanan -->
        <div class="text-right space-y-6">
          <h3 class="text-lg font-semibold text-white">Explore</h3>
          <ul class="space-y-1">
            <li><a href="/"        class="hover:text-white/80">Beranda</a></li>
            <li><a href="#tentang" class="hover:text-white/80">Tentang Kami</a></li>
            <li><a href="#resep"   class="hover:text-white/80">Resep</a></li>
          </ul>

          <!-- ikon sosmed lain -->
          <div class="flex justify-end gap-4 pt-4">
            <!-- pinterest -->
            <span class="w-5 h-5">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="currentColor"
                viewBox="0 0 496 600">
                <!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc. -->
                <path
                  d="M496 256c0 137-111 248-248 248-25.6 0-50.2-3.9-73.4-11.1 10.1-16.5 25.2-43.5 30.8-65 3-11.6 15.4-59 15.4-59 8.1 15.4 31.7 28.5 56.8 28.5 74.8 0 128.7-68.8 128.7-154.3 0-81.9-66.9-143.2-152.9-143.2-107 0-163.9 71.8-163.9 150.1 0 36.4 19.4 81.7 50.3 96.1 4.7 2.2 7.2 1.2 8.3-3.3 .8-3.4 5-20.3 6.9-28.1 .6-2.5 .3-4.7-1.7-7.1-10.1-12.5-18.3-35.3-18.3-56.6 0-54.7 41.4-107.6 112-107.6 60.9 0 103.6 41.5 103.6 100.9 0 67.1-33.9 113.6-78 113.6-24.3 0-42.6-20.1-36.7-44.8 7-29.5 20.5-61.3 20.5-82.6 0-19-10.2-34.9-31.4-34.9-24.9 0-44.9 25.7-44.9 60.2 0 22 7.4 36.8 7.4 36.8s-24.5 103.8-29 123.2c-5 21.4-3 51.6-.9 71.2C65.4 450.9 0 361.1 0 256 0 119 111 8 248 8s248 111 248 248z" />
              </svg>
            </span>
            <!-- facebook -->
            <a href="#" aria-label="Facebook" class="hover:text-white/80">
              <svg class="w-7 h-7" fill="currentColor" viewBox="0 0 24 24">
                <path d="M14 3h3V0h-3c-2.8 0-5 2.2-5 5v3H6v4h3v9h4v-9h3l1-4h-4V5c0-.6.4-1 1-1z"/>
              </svg>
            </a>
            <!-- youtube -->
            <a href="#" aria-label="YouTube" class="hover:text-white/80">
              <svg class="w-7 h-7" fill="currentColor" viewBox="0 0 24 24">
                <path d="M21.8 8s-.2-1.4-.8-2a2.8 2.8 0 0 0-2-1.1C16.3 4.5 12 4.5 12 4.5h0s-4.3 0-6.9.4a2.8 2.8 0 0 0-2 1.1c-.6.6-.8 2-.8 2S2 9.6 2 11.1v1.8c0 1.6.2 3.2.2 3.2s.2 1.4.8 2a2.8 2.8 0 0 0 2 1.1c2.6.4 6.9.4 6.9.4s4.3 0 6.9-.4a2.8 2.8 0 0 0 2-1.1c.6-.6.8-2 .8-2s.2-1.6.2-3.2v-1.8C22 9.6 21.8 8 21.8 8zM10 14.7V8.9l5.8 2.9L10 14.7z"/>
              </svg>
            </a>
          </div>
        </div>
      </div>
    </footer>
<div id="recipe-overlay" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
  <div class="bg-white rounded-lg shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col relative">
    <button id="close-overlay-btn" class="absolute top-3 right-3 bg-gray-100 rounded-full p-1 text-gray-600 hover:bg-gray-200 z-10"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>
    <div class="overflow-y-auto p-6 md:p-8">
      <div class="mb-6"><h2 id="overlay-title" class="text-2xl md:text-3xl font-extrabold text-rose-600 pr-8"></h2><div id="overlay-times" class="mt-3 flex items-center flex-wrap gap-x-4 gap-y-1 text-xs text-gray-600"></div></div>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <img id="overlay-image" src="" alt="" class="rounded-lg object-cover w-full h-auto max-h-96">
        <div id="overlay-ingredients-box" class="bg-amber-50 border border-amber-200 rounded-lg p-6">
          <h3 class="font-bold text-lg mb-4">Bahan-Bahan</h3><ul id="overlay-ingredients-list" class="space-y-2 text-sm list-disc list-inside"></ul>
        </div>
      </div>
      <div id="overlay-steps-box" class="mt-8"><h3 class="font-bold text-lg mb-4">Langkah-Langkah</h3><div id="overlay-steps-list" class="space-y-4 text-sm leading-relaxed"></div></div>
    </div>
  </div>
</div>
<script>
document.addEventListener("DOMContentLoaded", () => {
    
    // --- DATABASE RESEP (HARD-CODED) ---
    // Data ini akan digunakan untuk mengisi overlay
    const recipesData = [
        {
          id: '1', // ID ini harus cocok dengan ID resep di database Anda
          title: 'Sheet Pan Chicken Fajitas',
          image: 'assets/fajitas.png', // Pastikan path ini benar
          prepTime: '±15 menit',
          cookTime: '±25 menit',
          totalTime: '±40 menit',
          ingredients: [
            '1 pon (sekitar 450 gr) dada ayam tanpa tulang, iris tipis',
            '3 buah paprika (berbagai warna), iris tipis',
            '2 bawang bombay kecil (atau 1 besar), iris tipis',
            '2 sdm minyak goreng (zaitun, alpukat, atau sayur)',
            '8 buah tortilla ukuran 6-inci',
            '1 buah jeruk nipis, potong-potong',
            'Daun cilantro atau ketumbar segar (opsional, untuk taburan)',
            'Sour cream atau yogurt tawar (opsional, untuk saus)',
            'Bumbu Fajita (campurkan dalam satu mangkuk kecil):',
            '1 sdm bubuk cabai (chili powder)',
            '1/2 sdm paprika',
            '1/2 sdt bubuk bawang bombay (onion powder)',
            '1/4 sdt bubuk bawang putih (garlic powder)',
            '1/4 sdt jintan (cumin)',
            '1/2 sdt garam',
            'Sejumput bubuk cayenne (opsional, untuk rasa pedas)'
          ],
          steps: [
            '<strong>1. Panaskan Oven dan Siapkan Bumbu:</strong> Panaskan oven Anda hingga 400°F atau 200°C. Dalam sebuah mangkuk kecil, campurkan semua bahan untuk "Bumbu Fajita" dan aduk hingga rata.',
            '<strong>2. Siapkan Bahan Utama:</strong> Iris dada ayam, paprika, dan bawang bombay menjadi potongan memanjang setebal sekitar 1/4 inci.',
            '<strong>3. Bumbui Ayam dan Sayuran:</strong> Letakkan irisan ayam, paprika, dan bawang bombay di atas loyang panggang (sheet pan) yang besar. Siram dengan 2 sendok makan minyak goreng, lalu taburkan campuran bumbu fajita di atasnya.',
            '<strong>4. Aduk Rata:</strong> Gunakan tangan atau spatula besar untuk mengaduk semua bahan di atas loyang hingga ayam dan sayuran terlapisi minyak serta bumbu secara merata.',
            '<strong>5. Panggang:</strong> Panggang di dalam oven yang sudah dipanaskan selama 35-40 menit. Aduk atau balik bahan-bahan di tengah waktu memanggang (sekitar menit ke-20) agar matang merata.',
            '<strong>6. Sajikan:</strong> Setelah matang (ayam tidak lagi berwarna pink dan sayuran sedikit gosong di pinggirnya), keluarkan dari oven. Peras jus jeruk nipis di atasnya dan taburi dengan daun cilantro jika suka. Sajikan segera dengan tortilla hangat dan sour cream.'
          ]
        },
        // Anda bisa tambahkan data resep lain di sini dengan ID yang sesuai
                  {
          id: '2', // ID ini harus cocok dengan ID resep di database Anda
          title: 'Chocolate Chunk Coconut Pecan Skillet Cookie',
          image: 'assets/cookie.png', // Pastikan path ini benar
          prepTime: '±10 menit',
          cookTime: '±18-20 menit',
          totalTime: '±30 menit',
          ingredients: [
            '1 cangkir (2 batang / 226g) mentega tawar',
            '1 1/4 cangkir gula cokelat muda, padat',
            '2 butir telur',
            '1 sendok makan vanila ekstrak',
            '2 1/4 cangkir tepung serbaguna',
            '1 sendok teh baking soda',
            '1/2 sendok teh garam',
            '1 cangkir kelapa kering manis',
            '1/2 cangkir pecan cincang',
            '1 1/2 cangkir cokelat chunk (atau chocolate chips)',
            'Garam laut kasar (opsional)'
          ],
          steps: [
            '<strong>1. Panaskan Oven:</strong> Panaskan oven ke suhu 175°C (350°F). Siapkan wajan besi ukuran 26–30 cm (10–12 inci), olesi tipis dengan mentega.',
            '<strong>2. Campur Bahan Basah:</strong> Dalam mangkuk besar, kocok mentega dan gula cokelat hingga lembut dan menyatu. Tambahkan telur satu per satu, lalu masukkan vanila.',
            '<strong>3. Masukkan Bahan Kering:</strong> Campurkan tepung, baking soda, dan garam ke dalam adonan. Aduk hingga rata.',
            '<strong>4. Tambahkan Isian:</strong> Masukkan kelapa, pecan, dan cokelat chunk. Aduk rata',
            '<strong>5. Tuang ke Wajan:</strong> Masukkan adonan ke wajan, ratakan permukaannya.',
            '<strong>6. Panggang:</strong> Panggang selama ±18–20 menit atau hingga bagian atasnya berwarna keemasan, tapi bagian tengahnya masih sedikit lembek (supaya chewy!).',
            '<strong>7. Sajikan:</strong> Sajikan langsung dari wajan. Tambahkan garam laut di atasnya jika suka. Nikmati hangat-hangat — cocok banget dengan es krim vanila '
          ]
        },
          {
          id: '3', // ID ini harus cocok dengan ID resep di database Anda
          title: 'Spicy Tuscan Chicken Pasta',
          image: 'assets/pasta.png', // Pastikan path ini benar
          prepTime: '±10 menit',
          cookTime: '±20 menit',
          totalTime: '±30 menit',
          ingredients: [
            '500 gr pasta (seperti penne atau fusilli)',
            '2 sdm minyak zaitun',
            '2 dada ayam tanpa tulang, potong dadu',
            '2 sdt oregano kering',
            'Garam dan lada hitam secukupnya',
            '4 siung bawang putih, cincang',
            '1 sdm mentega',
            '1/2 cangkir tomat kering, potong kecil',
            '1 sdt serpihan cabai merah (opsional)',
            '1 cangkir krim kental',
            '3/4 cangkir keju parmesan parut',
            '2 cangkir bayam segar',
            '1/4 cangkir daun basil segar, cincang',
            'Air rebusan pasta (opsional, jika butuh encerkan saus)'
          ],
          steps: [
            '<strong>1. Rebus:</strong> Rebus pasta dalam air garam hingga al dente. Sisihkan ±1 cangkir air rebusan, tiriskan pasta.',
            '<strong>2. Masak Ayam:</strong> Panaskan minyak zaitun di wajan besar. Masukkan ayam, taburi oregano, garam, dan lada. Masak hingga matang dan kecokelatan (±5–8 menit). Angkat dari wajan.',
            '<strong>3. Tumis Bawang dan Tomat:</strong> Di wajan yang sama, lelehkan mentega, tumis bawang putih dan tomat kering selama ±2 menit hingga harum. Tambahkan serpihan cabai jika suka pedas.',
            '<strong>4. Buat Saus:</strong> Tuang krim kental, aduk rata. Masak 2–3 menit hingga sedikit mengental. Tambahkan parmesan, aduk hingga meleleh. Tambahkan bayam dan basil, aduk sampai layu.',
            '<strong>5. Gabungkan:</strong> Masukkan ayam dan pasta ke dalam saus. Aduk rata. Jika terlalu kental, tambahkan air rebusan pasta sedikit demi sedikit.',
            '<strong>6. Sajikan:</strong> Taburi parmesan tambahan dan basil. Nikmati hangat!'
          ]
        },

                {
          id: '4', // ID ini harus cocok dengan ID resep di database Anda
          title: 'Crockpot Hearty Chicken and Rice Soup',
          image: 'assets/crockpot.png', // Pastikan path ini benar
          prepTime: '15 menit',
          cookTime: '4 jam (slow)',
          totalTime: '4 jam 15 menit',
          ingredients: [
            '2 sdm minyak zaitun extra virgin',
            '1 bawang bombay, cincang',
            '2 wortel, iris tipis',
            '2 batang seledri, iris',
            '4 siung bawang putih, cincang',
            '1 sdm thyme kering',
            '2 lembar daun salam',
            '1 sdt serpihan cabai merah (opsional)',
            'Garam dan lada hitam secukupnya',
            '8 cangkir kaldu ayam',
            '1 cangkir beras putih atau merah',
            '2 dada ayam tanpa tulang',
            '1 sdm kecap asin',
            '1/2 cangkir daun parsley segar, cincang',
            'Jus dari 1/2 lemon'
          ],
          steps: [
            '<strong>1. Siapkan Crock-Pot:</strong> Masukkan potongan dada ayam tanpa tulang, bawang bombay, wortel, dan seledri ke dalam slow cooker atau crock-pot.',
            '<strong>2. Tambahkan Cairan dan Bumbu:</strong> Tuangkan kaldu ayam dan beras. Masukkan bawang putih cincang, thyme kering, daun salam, serpihan cabai merah (jika suka), garam, dan lada hitam.',
            '<strong>3. Masak Perlahan:</strong> Tutup crock-pot dan masak dengan pengaturan "Low" selama 6-8 jam atau "High" selama 3-4 jam, hingga ayam sangat empuk dan mudah disuwir.',
            '<strong>4. Suwir Ayam:</strong> Angkat potongan dada ayam dari sup dan letakkan di atas talenan. Gunakan dua garpu untuk menyuwir daging ayam, lalu masukkan kembali suwiran ayam ke dalam crock-pot.',
            '<strong>5. Sentuhan Akhir:</strong> Buang daun salam. Masukkan kecap asin, parsley segar yang sudah dicincang, dan jus lemon. Aduk rata. Cicipi dan koreksi rasa jika perlu. Sajikan sup selagi hangat.'
          ]
        },
    ];

    // --- LOGIKA OTENTIKASI & NAVBAR ---
    // (Kode ini tidak diubah)
    function getUser() {
        if (window.__USER__) return window.__USER__;
        try { const ls = localStorage.getItem("user"); if (ls) return JSON.parse(ls); } catch {}
        try { const m = document.cookie.match(/(?:^|;)\s*user=([^;]+)/); if (m) return JSON.parse(decodeURIComponent(m[1])); } catch {}
        return null;
    }
    const user = getUser();
    if (user) {
        document.getElementById("nav-user").textContent = user.name;
        document.getElementById("user-box").classList.remove("hidden");
        document.querySelectorAll(".hide-when-auth").forEach(el => el.remove());
        const menu = document.getElementById("user-menu");
        document.getElementById("nav-user").addEventListener("click", () => menu.classList.toggle("hidden"));
        document.addEventListener("click", (e) => { if (!document.getElementById("user-box").contains(e.target)) menu.classList.add("hidden"); });
    }

    // --- LOGIKA OVERLAY ---
    const overlay = document.getElementById('recipe-overlay');
    const closeBtn = document.getElementById('close-overlay-btn');
    const recipeListContainer = document.getElementById('recipe-list');
    
    const overlayTitle = document.getElementById('overlay-title');
    const overlayTimes = document.getElementById('overlay-times');
    const overlayImage = document.getElementById('overlay-image');
    const overlayIngredientsList = document.getElementById('overlay-ingredients-list');
    const overlayStepsList = document.getElementById('overlay-steps-list');

    function openOverlay(recipeId) {
        const recipe = recipesData.find(r => r.id === recipeId);
        if (!recipe) {
            alert('Maaf, detail untuk resep ini belum tersedia.');
            return;
        }
        overlayTitle.textContent = recipe.title;
        overlayImage.src = recipe.image;
        overlayImage.alt = recipe.title;
        overlayTimes.innerHTML = `<span>Persiapan: ${recipe.prepTime}</span><span>•</span><span>Memasak: ${recipe.cookTime}</span><span>•</span><span>Total: ${recipe.totalTime}</span>`;
        overlayIngredientsList.innerHTML = recipe.ingredients.map(item => `<li>${item}</li>`).join('');
        overlayStepsList.innerHTML = recipe.steps.map(step => `<p>${step}</p>`).join('');
        overlay.classList.remove('hidden');
    }

    function closeOverlay() {
        overlay.classList.add('hidden');
    }

    // Menggunakan event delegation untuk tombol resep yang dinamis
    recipeListContainer.addEventListener('click', (event) => {
        const button = event.target.closest('.recipe-btn');
        if (button) {
            const card = button.closest('[data-recipe-id]');
            const recipeId = card.dataset.recipeId;
            openOverlay(recipeId);
        }
    });

    closeBtn.addEventListener('click', closeOverlay);
    overlay.addEventListener('click', (event) => { if (event.target === overlay) closeOverlay(); });
    window.addEventListener('keydown', (event) => { if (event.key === 'Escape' && !overlay.classList.contains('hidden')) closeOverlay(); });

    // --- LOGIKA PENGAMBILAN DATA (FETCH) ---
    
    // Fungsi untuk merender kartu resep (diubah untuk memicu overlay)
    function renderRecipes(recipes) {
        const box = document.getElementById('recipe-list');
        if (!recipes || !recipes.length) {
            box.innerHTML = '<p class="text-sm text-gray-600">Maaf, belum ada resep yang cocok dengan preferensi rasamu.</p>';
            return;
        }
        box.innerHTML = '';
        recipes.forEach(r => {
            const card = document.createElement('div');
            card.className = 'flex flex-col items-center text-center w-full max-w-sm';
            // TAMBAHKAN: data-recipe-id dari database
            card.dataset.recipeId = r.id; 
            
            // DIUBAH: Menggunakan <button> bukannya <a>
            card.innerHTML = `
                <img src="${r.image_url || 'assets/default-recipe.png'}" alt="${r.title}" class="rounded-lg object-cover h-64 w-full" />
                <h2 class="mt-5 mb-4 font-semibold leading-tight">${r.title}</h2>
                <button class="recipe-btn mt-auto self-center bg-emerald-600 text-white py-2 px-7 rounded-full text-sm hover:bg-emerald-700 transition">Lihat Detail</button>
            `;
            box.appendChild(card);
        });
    }

    // Fungsi utama untuk memulai pengambilan data (tidak diubah)
    async function init() {
        try {
            const prefResponse = await fetch('/api/prefs/food');
            if (!prefResponse.ok) throw new Error('Gagal mengambil preferensi.');
            const userPreferences = await prefResponse.json();
            const targetTaste = userPreferences.angry || 'asin'; // Fallback ke 'asin' karena kita punya data resep asin
            const recipeResponse = await fetch(`/api/recipes/recommend?taste=${targetTaste}`);
            if (!recipeResponse.ok) throw new Error('Gagal mengambil resep.');
            const recommendedRecipes = await recipeResponse.json();
            renderRecipes(recommendedRecipes);
        } catch (err) {
            console.error('Terjadi kesalahan saat memuat resep:', err);
            const box = document.getElementById('recipe-list');
            box.innerHTML = '<p class="text-sm text-red-600">Terjadi kesalahan saat memuat resep. Coba lagi nanti.</p>';
        }
    }
    
    init(); // Jalankan pengambilan data resep

    // Logika untuk Musik (tidak diubah)
    fetch('/api/recs?mood=sad')
      .then(r => r.ok ? r.json() : Promise.reject('Gagal memuat rekomendasi musik'))
      .then(t => {
        const box = document.getElementById('music-card');
        box.innerHTML = `<iframe src="${t.embed}" class="w-full max-w-sm h-80 rounded-lg shadow" allow="encrypted-media; clipboard-write; picture-in-picture" loading="lazy"></iframe><p class="mt-4 italic text-sm">${t.caption}</p><a href="${t.uri}" target="_blank" rel="noopener" class="mt-3 inline-block px-8 py-2 rounded-full bg-rose-400 text-white text-xs hover:bg-rose-500">Putar Sekarang</a>`;
      })
      .catch(msg => { document.getElementById('music-card').innerHTML = `<p class="text-sm text-red-600">${msg}</p>` });
});
</script>
</body>
</html>